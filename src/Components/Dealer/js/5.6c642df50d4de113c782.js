webpackJsonp([5],{"7F2V":function(e,t){},Xu8Z:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("gyMJ"),n={props:["showUnreadMsg"],data:function(){return{dialogVisible:!1,unreadMsgNum:0,unreadFeedbackNum:0,timeObj:null,loodTime:6e4,activeName:"system"}},components:{messageComp:function(){return s.e(138).then(s.bind(null,"fA6O")).catch()},feedback:function(){return s.e(140).then(s.bind(null,"fkey")).catch()},sent:function(){return s.e(130).then(s.bind(null,"7A6a")).catch()},sendMessageComp:function(){return s.e(82).then(s.bind(null,"02iu")).catch()}},computed:{auth:function(){return this.$store.state.auth}},methods:{setVisible:function(e){if(this.dialogVisible=e,e=!0){var t=this;setTimeout(function(){t.getList()},100)}},getList:function(){this.$refs.messageComp.getList(),this.$refs.sent.getList(),this.auth.hasFeedback&&this.$refs.feedback.getList()},tabClick:function(){"system"==this.activeName?this.$refs.messageComp.showDetail=!1:"feedback"==this.activeName?this.$refs.feedback.showDetail=!1:this.$refs.sent.showDetail=!1},emitNum:function(){var e=Math.max(this.unreadMsgNum,this.unreadFeedbackNum);this.$emit("setNum",e)},getUnreadMsgNum:function(){var e=this;Object(a._157)().then(function(t){e.unreadMsgNum=t.record,e.emitNum()}).catch(function(){})},refreshReadNum:function(e){"message"==e&&this.getUnreadMsgNum(),"feedback"==e&&this.getUnreadFeedbackNum()},clearUnReadNum:function(e){"message"==e&&(this.unreadMsgNum=0),"feedback"==e&&(this.unreadFeedbackNum=0),this.emitNum()},delReadNum:function(e){"message"==e&&this.unreadMsgNum--,"feedback"==e&&this.unreadFeedbackNum--,this.emitNum()},getUnreadFeedbackNum:function(){var e=this;Object(a._156)().then(function(t){e.unreadFeedbackNum=t.record,e.emitNum()}).catch(function(){})},getunreadNum:function(){this.getUnreadMsgNum(),this.auth.hasFeedback&&this.getUnreadFeedbackNum()},setrVsbEvent:function(){var e=this.getBrowserVisibilityEventKey();document.addEventListener(e.ev,this.weekupSleepFn)},weekupSleepFn:function(){var e=this,t=this.getBrowserVisibilityEventKey();"visible"==document[t.stat]?this.timeObj=setInterval(function(){e.getunreadNum()},e.loodTime):"hidden"==document[t.stat]&&clearInterval(this.timeObj)},showSendMessage:function(){this.$refs.sendMessageComp.setVisible(!0),this.$refs.sendMessageComp.setData(this.userInfo)},dialogCloseFn:function(){this.$refs.messageComp.reset(),this.$refs.feedback.reset(),this.$refs.sent.reset()},setActiveTab:function(e){this.activeName=e},initUnreadMsg:function(){this.getunreadNum();var e=this;this.timeObj=setInterval(function(){e.getunreadNum()},e.loodTime),this.setrVsbEvent()}},mounted:function(){var e=this;this.$nextTick(function(){e.showUnreadMsg&&e.initUnreadMsg()})}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"},{name:"mouseClose",rawName:"v-mouseClose"}],staticClass:"message-dialog",attrs:{title:e.lg.message,"append-to-body":!0,visible:e.dialogVisible,modal:!0,"show-close":!0,width:"900px"},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.dialogCloseFn}},[s("div",{staticClass:"links"},[s("a",{attrs:{href:"javascript://"},on:{click:e.showSendMessage}},[s("i",{staticClass:"base-icon message-icon"}),e._v(e._s(e.lg.sendMessage))])]),e._v(" "),s("el-tabs",{on:{"tab-click":e.tabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:e.lg.message+"("+e.unreadMsgNum+")",name:"system"}},[s("messageComp",{ref:"messageComp",on:{delReadNum:e.delReadNum,clearUnReadNum:e.clearUnReadNum,refreshReadNum:e.refreshReadNum}})],1),e._v(" "),e.auth.hasFeedback?s("el-tab-pane",{attrs:{label:e.lg.customerService+"("+e.unreadFeedbackNum+")",name:"feedback"}},[s("feedback",{ref:"feedback",on:{delReadNum:e.delReadNum,clearUnReadNum:e.clearUnReadNum,refreshReadNum:e.refreshReadNum}})],1):e._e(),e._v(" "),s("el-tab-pane",{attrs:{label:e.lg.sent,name:"sent"}},[s("sent",{ref:"sent"})],1)],1),e._v(" "),s("sendMessageComp",{ref:"sendMessageComp"})],1)},staticRenderFns:[]};var u=s("VU/8")(n,i,!1,function(e){s("7F2V")},null,null);t.default=u.exports}});