webpackJsonp([138],{"Llh+":function(t,e){},fA6O:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("gyMJ"),a={data:function(){return{records:[],total:0,start:0,pagesize:5,loading:!1,showDetail:!1,detailObj:{},multipleSelection:[]}},components:{detailComp:function(){return s.e(81).then(s.bind(null,"aPDQ")).catch()}},methods:{getList:function(){var t=this;this.loading=!0,Object(n._53)({start:this.start,count:this.pagesize}).then(function(e){t.loading=!1,t.records=e.records,t.total=e.totalcount}).catch(function(){t.loading=!1})},fmtTime:function(t,e,s,n){return s?this.utcToLocal(s):"-"},handleCurrentChange:function(t){this.start=(Number(t)-1)*this.pagesize,this.getList()},deleteMsg:function(t){var e=this;this.$confirm(lg.delRecord).then(function(){Object(n.Z)({messageid:t.messageid}).then(function(t){e.$message.success(lg.delSuccess),1==e.records.length&&0!=e.start&&(e.start=e.start-e.pagesize),e.getList()}).catch(function(){})}).catch(function(){})},delAll:function(){var t=this;this.$confirm(lg.allDeleteTips).then(function(){Object(n.W)({}).then(function(e){t.$message.success(lg.delSuccess),t.getList(),t.$emit("clearUnReadNum","message")}).catch(function(){})}).catch(function(){})},readAll:function(){var t=this;this.$confirm(lg.allReadTips).then(function(){Object(n._111)({}).then(function(e){t.$message.success(lg.success),t.getList(),t.$emit("clearUnReadNum","message")}).catch(function(){})}).catch(function(){})},delSelectMsg:function(){var t=this,e=[];this.multipleSelection.forEach(function(t,s,n){e.push(t.messageid)}),this.$confirm(lg.delRecord).then(function(){Object(n.v)({messageids:e.join(",")}).then(function(e){t.$message.success(lg.delSuccess),t.getList(),t.$emit("refreshReadNum","message")}).catch(function(){})}).catch(function(){})},rowClick:function(t,e,s){t.readstatus||this.readFn(t)},rowClassFn:function(t){var e=t.row;t.rowIndex;return e.readstatus?"":"unread"},readFn:function(t){var e=this;Object(n._113)({messageid:t.messageid}).then(function(s){e.$set(t,"readstatus",1),e.$emit("delReadNum","message")}).catch(function(){})},showDetailFn:function(t){this.detailObj=t,this.$refs.detailComp.setData(t),this.showDetail=!0},backList:function(){this.showDetail=!1,this.detailObj={}},handleSelectionChange:function(t){this.multipleSelection=t},reset:function(){this.showDetail=!1}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showDetail,expression:"!showDetail"}]},[s("div",{staticClass:"mb15"},[s("el-button",{attrs:{disabled:0==t.multipleSelection.length},on:{click:t.delSelectMsg}},[t._v(t._s(t.lg.delete))]),t._v(" "),s("el-button",{on:{click:t.readAll}},[t._v(t._s(t.lg.allRead))]),t._v(" "),s("el-button",{on:{click:t.delAll}},[t._v(t._s(t.lg.deleteAll))])],1),t._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"message-table",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:t.records,"show-header":!1,stripe:"","row-class-name":t.rowClassFn},on:{"selection-change":t.handleSelectionChange,"row-click":t.rowClick}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{prop:"readstatus",width:"55"},scopedSlots:t._u([{key:"default",fn:function(t){return[s("span",{staticClass:"message-status",class:"0"==t.row.readstatus?"message-not-read":"message-read"})]}}])}),t._v(" "),s("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"link txt-ellipsis pointer",on:{click:function(s){return t.showDetailFn(e.row)}}},[t._v("\n            "+t._s(e.row.content)+"\n          ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"createtime",width:"160",formatter:t.fmtTime}}),t._v(" "),s("el-table-column",{attrs:{width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("a",{staticClass:"link-btn",on:{click:function(s){return t.deleteMsg(e.row)}}},[t._v(t._s(t.lg.delete))])]}}])})],1),t._v(" "),t.total?s("el-pagination",{attrs:{"page-size":t.pagesize,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}}):t._e()],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}]},[s("div",{staticClass:"mb10"},[s("a",{staticClass:"link-btn",on:{click:t.backList}},[s("i",{staticClass:"base-icon back-icon"}),t._v(t._s(t.lg.back))])]),t._v(" "),s("detailComp",{ref:"detailComp"})],1)])},staticRenderFns:[]};var l=s("VU/8")(a,i,!1,function(t){s("Llh+")},null,null);e.default=l.exports}});