webpackJsonp([128],{Nxpd:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Zlha"),i=n("gyMJ"),o=n("KvKp"),a=(n("iKHV"),{props:["source"],mixins:[r.a],data:function(){return{customerid:"",loading:!1,record:[],chart:null}},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},computed:{loginId:function(){return this.$store.state.loginId}},methods:{refreshFn:function(){this.chart||this.initChart(),this.getData()},changeCustomerId:function(t){this.customerid!=t&&(this.customerid=t,this.findChart())},getData:function(){var t=this;Object(i._6)({customerid:this.customerid}).then(function(e){t.loading=!1,t.renderChart(e.record.data)}).catch(function(e){t.loading=!1})},changeZoom:function(t){var e=this.chart.getOption().geo[0].zoom,n=this.chart.getOption().geo[0].center;e=e+t>16?16:e+t<1?1:e+t,n=0!=n.length?n:["35.865574","31.9794395"],this.chart.setOption({geo:{center:n,zoom:e}})},renderChart:function(t){if(!t)return this.clearChart();t=t.split(";"),this.record=t;var e=[],n=[],r=[];if(t.length>1){var i=-1e3,a=1e3,c=-1e3,s=1e3;t.forEach(function(t,r){e=t.split(","),n.push({value:[e[0],e[1]]}),parseFloat(e[1])>parseFloat(c)&&(c=e[1]),parseFloat(e[1])<parseFloat(s)&&(s=e[1]),parseFloat(e[0])>parseFloat(i)&&(i=e[0]),parseFloat(e[0])<parseFloat(a)&&(a=e[0])}),r=Object(o.b)(i,a,c,s)}else e=t[0].split(","),n=[{value:[e[0],e[1]]}],r=[[parseFloat(e[0]),parseFloat(e[1])],5];this.chart.setOption({geo:{center:r[0],zoom:r[1]},series:[{data:n}]})},clearChart:function(){this.chart.setOption({geo:{center:[],zoom:1},series:[{data:[]}]})},initChart:function(){if(document.getElementById("chartMap"+(this.source?this.source:""))){this.chart=echarts.init(document.getElementById("chartMap"+(this.source?this.source:"")));var t=this,e={tooltip:{show:!0,formatter:function(e){var n=t.record[e.dataIndex];return lg.number+": "+(n?n.split(",")[2]:"-")}},geo:{map:"world",left:0,top:20,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]],center:[],zoom:1,label:{emphasis:{show:!0,shadowColor:"rgba(0,0,0,0.5)",color:"#333"}},roam:"move",scaleLimit:{min:1,max:16},itemStyle:{normal:{areaColor:"#e6e8e8",borderColor:"#f1f1f1"},emphasis:{areaColor:"#d1d1d1",color:"#343434"}},regions:[]},series:[{type:"effectScatter",coordinateSystem:"geo",zlevel:2,symbolSize:10,rippleEffect:{brushType:"stroke",scale:5,period:8},itemStyle:{normal:{color:"#0795fb"}},data:[]}]};this.chart.setOption(e)}},findChart:function(){var t=this;"undefined"==typeof echarts?(this.loadScript("./static/plugins/echart/echarts.min.js"),setTimeout(function(){t.loadScript("./static/plugins/echart/world.js")},2e3)):echarts.getMap("world")||setTimeout(function(){t.loadScript("./static/plugins/echart/world.js")},2e3);!function e(){"undefined"!=typeof echarts&&echarts.getMap("world")?(t.loading=!0,t.chart||t.initChart(),t.getData()):setTimeout(function(){e()},100)}()}},mounted:function(){var t=this;this.$nextTick(function(){t.source||(t.customerid=t.loginId,t.findChart())})}}),c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"device-map"},[n("h3",{staticClass:"panel-title"},[t._v(t._s(t.lg.deviceDeployment))]),t._v(" "),n("div",{staticClass:"zoom-btn"},[n("el-button",{attrs:{icon:"el-icon-minus"},on:{click:function(e){return t.changeZoom(-1.5)}}}),t._v(" "),n("el-button",{attrs:{icon:"el-icon-plus"},on:{click:function(e){return t.changeZoom(1.5)}}})],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"device-chart-Map",attrs:{id:"chartMap"+(t.source?t.source:"")}})])},staticRenderFns:[]};var s=n("VU/8")(a,c,!1,function(t){n("dQ2A")},null,null);e.default=s.exports},dQ2A:function(t,e){},iKHV:function(t,e,n){"use strict";n.d(e,"d",function(){return r}),n.d(e,"i",function(){return i}),n.d(e,"j",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"m",function(){return c}),n.d(e,"b",function(){return s}),n.d(e,"l",function(){return u}),n.d(e,"k",function(){return d}),n.d(e,"f",function(){return l}),n.d(e,"h",function(){return h}),n.d(e,"g",function(){return f}),n.d(e,"e",function(){return p}),n.d(e,"n",function(){return m}),n.d(e,"c",function(){return v}),n.d(e,"o",function(){return b});var r=function(t){return!(!t||!/^([0-9A-Za-z\_\@\.]){2,30}$/.test(t))},i=function(t){return!!(t&&t.length<=20&&t.length>=6)},o=function(t){return"123456"!=t},a=100,c=64,s=150,u=function(t){return!!t.match(/^(\+[0-9]{1,20}|[0-9]{1,21})$/)},d=function(t){return t.indexOf("@")>0&&t.indexOf(".")>0&&!!t.match(/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)},l=function(t){return/(^[a-zA-Z\d]{6,15}$)/.test(t)},h=function(t){return/(^[a-zA-Z\d]{5,18}$)/.test(t)},f=function(t){for(var e,n=[],r=!0,i=0,o=t.length;i<o;i++)if(e=t[i].replace(/^\s+|\s+$/gm,""),n.push(e),!l(e)){r=!1;break}return{imeis:n,rs:r}},p=function(t){return!!(/^\d+(\.5)?$/.test(t)&&parseInt(t)>=0&&parseInt(t)<=5e3)},m=function(t,e){var n={beginTime:(e=e||"")?new Date(new Date(e).getTime()).setHours(0,0,0,0):(new Date).getTime()};return n.endTime=n.beginTime+864e5*t-1,n},g=function(t,e){if(t+="",e||(e=0),-1==t.indexOf(".")&&(t+="."),t+=new Array(e+1).join("0"),new RegExp("^(-|\\+)?(\\d+(\\.\\d{0,"+(e+1)+"})?)\\d*$").test(t)){t="0"+RegExp.$2;var n=RegExp.$1,r=RegExp.$3.length,i=!0;if(r==e+2){if(r=t.match(/\d/g),parseInt(r[r.length-1])>4)for(var o=r.length-2;o>=0&&(r[o]=parseInt(r[o])+1,10==r[o]);o--)r[o]=0,i=1!=o;t=r.join("").replace(new RegExp("(\\d+)(\\d{"+e+"})\\d$"),"$1.$2")}return i&&(t=t.substr(1)),parseFloat((n+t).replace(/\.$/,""))}return t+""},v=function(t,e,n){return 0==t&&"temperature"!=e||void 0===n?t:"distance"==e?g("2"==n?.621*t:t,2):"pressure"==e?["",g(.145*t,2),g(.01*t,2),g(t,2)][n]:"capacity"==e?["",g(t,2),g(.264*t,2),g(.22*t,2)][n]:"temperature"==e?g("2"==n?1.8*t+32:t,2):"fuelefficiency"==e?["",g(t,2),g(62.1/(.264*t),2),g(62.1/(.22*t),2)][n]:t},b=function(t,e,n){return 0==t&&"temperature"!=e||void 0===n?t:"distance"==e&&1!=n?g(t/.621,2):"pressure"==e?["",g(t/.145,2),g(t/.01,2),g(t,2)][n]:"capacity"==e?["",g(t,2),g(t/.264,2),g(t/.22,2)][n]:"temperature"==e?g("2"==n?(t-32)/1.8:t,2):"fuelefficiency"==e?["",g(t,2),g(62.1/(.264*t),2),g(62.1/(.22*t),2)][n]:t}}});