webpackJsonp([14],{LWGJ:function(t,i){},XKPe:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n={data:function(){return{visible:!1,initFlag:!1,menuHeight:0,hover:0}},computed:{sidebar:function(){return this.$store.state.sidebar},path:function(){return this.$route.path},permission:function(){return this.$store.state.functions}},components:{funcComp:e("noE1").default},methods:{show:function(){if(!this.visible){this.visible=!0;var t=this;setTimeout(function(){t.setFunctionsPosition()},10)}},hoverFn:function(){this.hover=1},hide:function(){this.$refs.funcComp.popoverHide(),this.visible=!1,this.hover=0,document.getElementsByClassName("function-menu-dialog")[0].style.left="-1000px"},hoverHide:function(){this.hide()},setFunctionsPosition:function(){if(this.permission){var t=document.getElementsByClassName("function-menu-dialog")[0];if(t&&this.visible){var i=this.sidebar.opened?370:240,e=t.offsetHeight/2,n=document.getElementsByClassName("function-menu-item")[0],s=document.documentElement.clientHeight-(n.offsetTop+i)-e,o=s>0?s:0;t.style.bottom=o+10+"px",t.style.left=n.offsetWidth-1+"px",this.setItemHeight()}}else{var r=this;setTimeout(function(){r.setFunctionsPosition()},300)}},setItemHeight:function(){var t=document.getElementsByClassName("function-menu-dialog")[0],i=840;document.documentElement.clientHeight-50<i&&(i=document.documentElement.clientHeight-50),t.style["max-height"]=i+"px";var e=document.querySelector(".function-menu-dialog .function-cont").offsetHeight,n=document.querySelector(".function-menu-dialog .func-filter-box").offsetHeight,s=0;s=e+n+40<i?e+20:i-n-40,this.menuHeight>s?s=this.menuHeight:this.menuHeight=s;var o=this;this.findObj("funcComp",this.$refs,function(){o.$refs.funcComp.setScrollHeight(s)})},itemClick:function(){this.hide()}},mounted:function(){var t=this.$el;document.body.appendChild(t),this.$store.state.myFunctions||this.$store.dispatch("getFunctionsAll")}},s={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"function-menu-dialog functions-menu",attrs:{"data-show":t.hover},on:{mouseover:t.hoverFn,mouseleave:function(i){return t.hoverHide()}}},[e("funcComp",{ref:"funcComp",attrs:{source:"menu"},on:{itemClick:t.itemClick}})],1)},staticRenderFns:[]};var o=e("VU/8")(n,s,!1,function(t){e("l7LV")},null,null);i.default=o.exports},hG1a:function(t,i){},l7LV:function(t,i){},noE1:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("mvHQ"),s=e.n(n),o=(e("gyMJ"),{props:["source"],data:function(){return{menuScrollHeight:0,searchKey:"",tabType:["All","Admin","Sales","Customer"],loading:!1,toggleTypeArr:[],functionWorkData:[],functionWorkIds:[],curData:{},storageFunctions:{},filterType:"0",searchResults:[]}},computed:{showFilterType:function(){return this.myFunctions.length>9&&this.roleid<3},packdataAll:function(){var t=this;if(this.permission){var i=[],e=void 0;return this.configArr.forEach(function(n){e=n.data.filter(function(i){return t.permission&&t.permission[i.permission]}),i.push({type:n.type,name:n.name,data:e})}),i}},packdata:function(){var t=this;if(this.permission){var i=[],e=void 0;return this.configArr.forEach(function(n){n.data.length&&(n.data=n.data.sort(function(t,i){return t.indexorder-i.indexorder})),e=n.data.filter(function(i){return t.permission&&t.permission[i.permission]&&(t.inArray(i.role,parseInt(t.filterType))||0==t.filterType||!t.showFilterType)&&t.inSearchResult(i.permission)}),i.push({type:n.type,name:n.name,data:e})}),i}},myFunctions:function(){var t=this;if(!this.permission)return[];var i=[];return(this.$store.state.myFunctions||[]).forEach(function(e){e.value=lg[e.i18n],t.permission[e.permission]&&i.push(e)}),i},roleid:function(){return this.$store.state.customerInfo.customerroleid},permissionConfig:function(){return this.$store.state.myFunctions||[]},configArr:function(){var t=this,i=[],e={};return(this.$store.state.functionTypes||[]).forEach(function(n){e=t.myFunctions.filter(function(t){return t.functiontype==n.functiontypeid}),i.push({type:n.i18n,name:lg[n.i18n],data:e})}),i},permission:function(){return this.$store.state.functions||[]},path:function(){return this.$route.path}},methods:{querySearch:function(t,i){var e=this.myFunctions,n=t?e.filter(this.createStateFilter(t)):e;this.searchResults=n,i(n)},createStateFilter:function(t){return function(i){return-1!==i.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){this.itemClick(t)},handleClose:function(t,i){this.clearNumber(t),this.functionWorkData.splice(i,1),this.inArray(this.functionWorkIds,t+"")&&this.functionWorkIds.splice(this.functionWorkIds.indexOf(t+""),1)},inSearchResult:function(t){var i=this.searchResults;if(this.searchKey){for(var e=0;e<i.length;e++)if(i[e].permission==t)return!0;return!1}return!0},addNumber:function(t){t+="";var i=this.findFunction(t),e=this.functionWorkIds.indexOf(t);i.num++,this.storageFunctions[i.permissionid]++,e>-1&&(this.functionWorkIds.splice(e,1),this.functionWorkData.splice(e,1)),this.functionWorkIds.unshift(t),this.functionWorkData.unshift(i),this.functionWorkIds.length>5&&(this.functionWorkData.length=5,this.functionWorkIds.length=5),this.setStoreFunctions(),this.setWorkData(),this.sortByNumber(this.permissionConfig,"num")},clearNumber:function(t){var i=this.findFunction(t);i.num=0,this.storageFunctions[i.permissionid]=0,this.setStoreFunctions(),this.setWorkData(),this.sortByNumber(this.permissionConfig,"num")},setStoreFunctions:function(){localStorage.setItem("functions",s()(this.storageFunctions))},setWorkData:function(){localStorage.setItem("functionWork",this.unique(this.functionWorkIds))},findFunction:function(t){return this.permissionConfig.find(function(i){return i.permissionid==+t})},itemClick:function(t){this.addNumber(t.permissionid),"1"==t.openway?window.open(t.router):this.$router.push(t.router),this.$emit("itemClick")},initStorageFunctions:function(t){if(0===(t=t.replace(/(NaN,)/g,"")).indexOf(",")){var i={};return t.split(",").forEach(function(t,e){t&&(i[e]=t)}),i}return JSON.parse(t)},initPermissionConfig:function(){var t=this;this.permissionConfig.forEach(function(i){t.storageFunctions[i.permissionid]||(t.storageFunctions[i.permissionid]=0),i.num=t.storageFunctions[i.permissionid]}),this.sortByNumber(this.permissionConfig,"num")},initFunctionNum:function(){var t=localStorage.getItem("functions");this.storageFunctions=t?this.initStorageFunctions(t):{},this.initPermissionConfig()},getFunctionWorkData:function(){var t,i=this,e=[],n=[];this.functionWorkIds?this.functionWorkIds.forEach(function(s){(t=i.findFunction(+s))&&i.permission&&i.permission[t.permission]&&(e.push(t),n.push(+s))}):this.permissionConfig.forEach(function(t){t.num>0&&e.length<5&&!i.inArray(i.functionWorkIds,t.permissionid+"")&&i.permission&&i.permission[t.permission]&&(e.push(t),n.push(t.permissionid))}),this.functionWorkData=e},initWorkData:function(){var t=localStorage.getItem("functionWork");this.functionWorkIds=t?this.unique(t.split(",")):[],this.getFunctionWorkData()},init:function(){if(this.permissionConfig.length)this.initFunctionNum(),this.initWorkData();else{var t=this;setTimeout(function(){t.init()},100)}},setScrollHeight:function(t){if(this.permission)this.menuScrollHeight=t;else{var i=this;setTimeout(function(){i.setScrollHeight(t)},300)}},popoverHide:function(){this.$refs.searchComp&&(this.$refs.searchComp.close(),this.searchKey="")},getStoreType:function(){var t=localStorage.getItem("toggleFuncType");return t?t.split(","):[]},toggleType:function(t){var i=this.getStoreType(),e=i.indexOf(t);-1!=e?i.splice(e,1):i.push(t),localStorage.setItem("toggleFuncType",i),this.toggleTypeArr=i},tabChanged:function(){localStorage.setItem("funcTab",this.tabType[this.filterType])},setFilterType:function(){var t=localStorage.getItem("funcTab");t&&this.inArray(this.tabType,t)?this.filterType=""+this.tabType.indexOf(t):this.filterType=this.roleid?this.roleid+"":"0"}},mounted:function(){var t=this;this.$nextTick(function(){t.init(),t.setFilterType(),t.toggleTypeArr=t.getStoreType()})},beforeDestroy:function(){var t=this;this.setWorkData(),window.removeEventListener("beforeunload",function(i){return t.setWorkData(i)})},deactivated:function(){this.setWorkData()}}),r={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"function-comp"},[e("div",{staticClass:"func-filter-box"},[t.myFunctions.length>9?e("div",{staticClass:"search-box"},[e("el-autocomplete",{ref:"searchComp",staticClass:"inline-input",attrs:{"fetch-suggestions":t.querySearch,"popper-append-to-body":!1,clearable:""},on:{select:t.handleSelect},scopedSlots:t._u([{key:"default",fn:function(i){var n=i.item;return[e("span",{attrs:{title:"count: "+n.num}},[t._v(t._s(t.lg[n.i18n]))])]}}],null,!1,4029126484),model:{value:t.searchKey,callback:function(i){t.searchKey=i},expression:"searchKey"}},[e("i",{staticClass:"search-icon base-icon",attrs:{slot:"prefix"},slot:"prefix"})])],1):t._e(),t._v(" "),t.myFunctions.length>9?e("div",{staticClass:"pt10"},t._l(t.functionWorkData,function(i,n){return e("el-tag",{key:t.source+"-"+i.permissionid,staticClass:"func-tag mr10",attrs:{title:"id:"+i.permissionid,closable:""},on:{click:function(e){return t.itemClick(i)},close:function(e){return t.handleClose(i.permissionid,n)}}},[t._v(t._s(t.lg[i.i18n]))])}),1):t._e(),t._v(" "),t.showFilterType?e("el-tabs",{on:{"tab-click":t.tabChanged},model:{value:t.filterType,callback:function(i){t.filterType=i},expression:"filterType"}},[t._l(t.tabType,function(i,n){return[1!=n||1==n&&1==t.roleid?e("el-tab-pane",{attrs:{label:i,name:""+n}}):t._e()]})],2):t._e()],1),t._v(" "),e("el-scrollbar",{staticClass:"function-m-scroll",style:{height:t.menuScrollHeight?t.menuScrollHeight+"px":"auto"}},[e("div",{staticClass:"function-cont"},t._l(t.packdata,function(i){return 0!=i.data.length?e("div",{class:"function-type-"+i.type},[e("div",{staticClass:"func-item-title func-item-type",on:{click:function(e){return t.toggleType(i.type)}}},[t._v(t._s(i.name)+"\n        "),t._v(" "),e("i",{staticClass:"ml5",class:t.inArray(t.toggleTypeArr,i.type)?"el-icon-arrow-right":"el-icon-arrow-down"})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.inArray(t.toggleTypeArr,i.type),expression:"!inArray(toggleTypeArr,item.type)"}]},[t._l(i.data,function(i){return[e("el-button",{staticClass:"func-item-btn",class:"function-menu-item "+(i.router==t.path?"is-active":""),attrs:{title:t.lg[i.i18n]},on:{click:function(e){return t.itemClick(i)}}},[e("i",{staticClass:"menu-icon",class:"func-"+i.permission}),t._v(" "),t._v("\n            \t"+t._s(t.lg[i.i18n])+"\n            ")])]})],2)]):t._e()}),0)])],1)},staticRenderFns:[]};var u=e("VU/8")(o,r,!1,function(t){e("LWGJ"),e("hG1a")},null,null);i.default=u.exports}});