webpackJsonp([146,150],{"5iOi":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("gyMJ"),i=r("iKHV"),n={props:["dialog"],data:function(){return{formData:{imei:"",deviceid:"",devicename:"-",nowPlatform:"-",cardtype:"2",number:"1",afterPlatform:"",distributortime:"",remark:""},afterPlatform:"",btnloading:!1}},computed:{auth_function:function(){return this.$store.state.functions||{}}},methods:{setVisible:function(t){this.$emit("rechargeCb")},setData:function(t){this.formData.imei=t.imei,this.formData.deviceid=t.deviceid,this.formData.devicename=t.devicename,this.formData.nowPlatform=this.utcToLocal(t.plattime).substr(0,10),this.afterPlatform=this.formatPlatform(t.plattime),this.formData.afterPlatform=this.afterPlatform,this.formData.distributortime=new Date(this.afterPlatform).getTime()},formatPlatform:function(t){var e=0;return(e=Date.now()>t?Date.now():t)>=new Date("2099-12-31 00:00:00").getTime()?"2099-12-31":this.utcToLocal(new Date(e).setFullYear(new Date(e).getFullYear()+1)).substr(0,10)},cardTypeChange:function(){var t="3"==this.formData.cardtype?"2099-12-31":this.afterPlatform;this.formData.afterPlatform=t,this.formData.distributortime=new Date(t).getTime()},isInWhitelistFn:function(t){var e=this;Object(a._74)({imei:t}).then(function(t){""==t.errormsg&&(e.formData.number="0.5")}).catch(function(t){})},onSubmit:function(){var t=this,e=this.checkParams();e&&(this.btnloading=!0,Object(a._114)(e).then(function(e){t.$message.success(lg.rechargeDeviceSuccess),t.btnloading=!1,t.setVisible(!1),t.resetFm()}).catch(function(e){t.btnloading=!1}),this.countEvent({action:"续费",opt_label:"点击",val:"Dealer2"}))},checkParams:function(){var t=this.$trim(this.formData.remark),e=this.formData.cardtype;if(!this.formData.distributortime)return this.$message.error(lg.platformEndError),!1;var r=Object(i.n)(1,this.formData.distributortime).endTime-999;return{remark:t,type:e,deviceid:this.formData.deviceid,distributortime:r}},fnHistory:function(){this.$router.push({path:"/imeirechargehistory",query:{imei:this.formData.imei}})},cancelFn:function(){this.$emit("close")},resetFm:function(){this.$refs.formComp.resetFields()}}},o={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-form",{ref:"formComp",staticClass:"recharge-form",attrs:{"show-message":!1,"label-position":"right",model:t.formData,"label-width":"200px"},nativeOn:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[r("el-form-item",{attrs:{label:t.lg.imei,required:"",prop:"imei"}},[r("el-input",{staticStyle:{width:"220px"},on:{blur:function(e){return t.$trimFn("formData","imei")}},model:{value:t.formData.imei,callback:function(e){t.$set(t.formData,"imei",e)},expression:"formData.imei"}})],1),t._v(" "),r("el-form-item",{attrs:{label:t.lg.targetName,prop:"devicename"}},[t._v("\n    "+t._s(t.formData.devicename)+"\n  ")]),t._v(" "),r("el-form-item",{attrs:{label:t.lg.platformEnd,prop:"nowPlatform"}},[t._v("\n    "+t._s(t.formData.nowPlatform)+"\n  ")]),t._v(" "),r("el-form-item",{attrs:{label:t.lg.cardType,prop:"cardtype"}},[r("el-radio",{attrs:{label:"2"},on:{change:t.cardTypeChange},model:{value:t.formData.cardtype,callback:function(e){t.$set(t.formData,"cardtype",e)},expression:"formData.cardtype"}},[t._v(t._s(t.lg.annualCard))]),t._v(" "),r("el-radio",{attrs:{label:"3"},on:{change:t.cardTypeChange},model:{value:t.formData.cardtype,callback:function(e){t.$set(t.formData,"cardtype",e)},expression:"formData.cardtype"}},[t._v(t._s(t.lg.lifeLongCard))])],1),t._v(" "),r("el-form-item",{attrs:{label:t.lg.afterRecharge,prop:"afterPlatform"}},[t._v("\n    "+t._s(t.formData.afterPlatform)+"\n  ")]),t._v(" "),r("el-form-item",{attrs:{label:t.lg.userEnd,required:"",prop:"distributortime"}},[r("el-date-picker",{attrs:{type:"date","value-format":"timestamp"},model:{value:t.formData.distributortime,callback:function(e){t.$set(t.formData,"distributortime",e)},expression:"formData.distributortime"}})],1),t._v(" "),r("el-form-item",{attrs:{label:t.lg.remark,prop:"remark"}},[r("el-input",{staticStyle:{width:"220px"},attrs:{type:"textarea",rows:2},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}})],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary","native-type":"submit",loading:t.btnloading}},[t._v(t._s(t.lg.submit))]),t._v(" "),t.dialog?r("el-button",{on:{click:t.cancelFn}},[t._v(t._s(t.lg.cancel))]):r("el-button",{on:{click:t.resetFm}},[t._v(t._s(t.lg.reset))]),t._v(" "),t.auth_function.imeirechargehistory?r("a",{attrs:{href:"javascript://"},on:{click:t.fnHistory}},[t._v(t._s(t.lg.rechargeHistory))]):t._e()],1)],1)},staticRenderFns:[]},s=r("VU/8")(n,o,!1,null,null,null);e.default=s.exports},iKHV:function(t,e,r){"use strict";r.d(e,"d",function(){return a}),r.d(e,"i",function(){return i}),r.d(e,"j",function(){return n}),r.d(e,"a",function(){return o}),r.d(e,"m",function(){return s}),r.d(e,"b",function(){return m}),r.d(e,"l",function(){return c}),r.d(e,"k",function(){return f}),r.d(e,"f",function(){return u}),r.d(e,"h",function(){return l}),r.d(e,"g",function(){return d}),r.d(e,"e",function(){return p}),r.d(e,"n",function(){return h}),r.d(e,"c",function(){return b}),r.d(e,"o",function(){return v});var a=function(t){return!(!t||!/^([0-9A-Za-z\_\@\.]){2,30}$/.test(t))},i=function(t){return!!(t&&t.length<=20&&t.length>=6)},n=function(t){return"123456"!=t},o=100,s=64,m=150,c=function(t){return!!t.match(/^(\+[0-9]{1,20}|[0-9]{1,21})$/)},f=function(t){return t.indexOf("@")>0&&t.indexOf(".")>0&&!!t.match(/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)},u=function(t){return/(^[a-zA-Z\d]{6,15}$)/.test(t)},l=function(t){return/(^[a-zA-Z\d]{5,18}$)/.test(t)},d=function(t){for(var e,r=[],a=!0,i=0,n=t.length;i<n;i++)if(e=t[i].replace(/^\s+|\s+$/gm,""),r.push(e),!u(e)){a=!1;break}return{imeis:r,rs:a}},p=function(t){return!!(/^\d+(\.5)?$/.test(t)&&parseInt(t)>=0&&parseInt(t)<=5e3)},h=function(t,e){var r={beginTime:(e=e||"")?new Date(new Date(e).getTime()).setHours(0,0,0,0):(new Date).getTime()};return r.endTime=r.beginTime+864e5*t-1,r},g=function(t,e){if(t+="",e||(e=0),-1==t.indexOf(".")&&(t+="."),t+=new Array(e+1).join("0"),new RegExp("^(-|\\+)?(\\d+(\\.\\d{0,"+(e+1)+"})?)\\d*$").test(t)){t="0"+RegExp.$2;var r=RegExp.$1,a=RegExp.$3.length,i=!0;if(a==e+2){if(a=t.match(/\d/g),parseInt(a[a.length-1])>4)for(var n=a.length-2;n>=0&&(a[n]=parseInt(a[n])+1,10==a[n]);n--)a[n]=0,i=1!=n;t=a.join("").replace(new RegExp("(\\d+)(\\d{"+e+"})\\d$"),"$1.$2")}return i&&(t=t.substr(1)),parseFloat((r+t).replace(/\.$/,""))}return t+""},b=function(t,e,r){return 0==t&&"temperature"!=e||void 0===r?t:"distance"==e?g("2"==r?.621*t:t,2):"pressure"==e?["",g(.145*t,2),g(.01*t,2),g(t,2)][r]:"capacity"==e?["",g(t,2),g(.264*t,2),g(.22*t,2)][r]:"temperature"==e?g("2"==r?1.8*t+32:t,2):"fuelefficiency"==e?["",g(t,2),g(62.1/(.264*t),2),g(62.1/(.22*t),2)][r]:t},v=function(t,e,r){return 0==t&&"temperature"!=e||void 0===r?t:"distance"==e&&1!=r?g(t/.621,2):"pressure"==e?["",g(t/.145,2),g(t/.01,2),g(t,2)][r]:"capacity"==e?["",g(t,2),g(t/.264,2),g(t/.22,2)][r]:"temperature"==e?g("2"==r?(t-32)/1.8:t,2):"fuelefficiency"==e?["",g(t,2),g(62.1/(.264*t),2),g(62.1/(.22*t),2)][r]:t}}});