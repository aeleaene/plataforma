webpackJsonp([94,88],{"9bBU":function(e,t,i){i("mClu");var r=i("FeBl").Object;e.exports=function(e,t,i){return r.defineProperty(e,t,i)}},C4MV:function(e,t,i){e.exports={default:i("9bBU"),__esModule:!0}},CZxx:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("Rpa2"),n=i("Glw6"),s=i("gyMJ"),o=i("KvKp"),a=i("iKHV"),c={props:["dialog"],data:function(){return{formData:{customerid:"",distributortime:(new Date).setFullYear((new Date).getFullYear()+1),imeis:""},btnloading:!1}},components:{userTreeSelect:r.default,imeiListComp:n.default},methods:{setCustomer:function(e,t){this.formData.customerid=e,this.$refs.userSelectComp.setCustomer(t)},setData:function(e){this.formData.imeis=e.join("\n"),this.formData.distributortime=(new Date).setFullYear((new Date).getFullYear()+1)},userSelected:function(e){this.formData.customerid=e.customerid},getImeis:function(){this.$refs.imeiListComp.getImeisInfoData(this.formData.imeis)},setImeis:function(e){this.formData.imeis=e?e.join("\n"):""},onSubmit:function(){var e=this,t=this.checkParams();if(t){this.btnloading=!0;var i=Object(o.e)(this.formData.imeis);Object(s.C)(t).then(function(r){e.$message.success(lg.sellTargerSuccess+"("+lg.success+":"+t.imeis.split(",").length+(i.length>0?", "+lg.repeated+":"+i.length:"")+")"),e.btnloading=!1,0==i.length&&e.reset(),e.$emit("sellSuccess")}).catch(function(t){e.btnloading=!1}),this.countEvent({action:"批量销售",opt_label:"点击",val:"Dealer2"})}},checkParams:function(){if(!this.formData.customerid)return this.$message.error(lg.selectSuperCustomerNull),!1;if(!this.formData.distributortime)return this.$message.error(lg.platformEndError),!1;var e=this.$trim(this.formData.imeis);if(!e)return this.$message.error(lg.inputImeiError),!1;if((e=this.formatImeis(e)).length>200)return this.$message.error(lg.maxImeiNum.replace("{num}",200)),!1;var t=Object(a.g)(e);if(!t.rs)return this.$message.error(lg[20053]+"("+t.imeis[t.imeis.length-1]+")"),!1;var i=Object(a.n)(1,this.formData.distributortime).endTime;return{customerid:this.formData.customerid,distributortime:i,imeis:t.imeis.join(",")}},cancelFn:function(){this.$emit("hideDialog")},reset:function(){this.formData.customerid="",this.$refs.formComp.resetFields(),this.$refs.userSelectComp.clearFn()}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"formComp",attrs:{"label-position":"right","show-message":!1,model:e.formData,"label-width":"150px"},nativeOn:{submit:function(t){return t.preventDefault(),e.onSubmit.apply(null,arguments)}}},[i("el-form-item",{attrs:{label:e.lg.aimCustomer,required:""}},[i("userTreeSelect",{ref:"userSelectComp",staticStyle:{width:"264px"},on:{selected:e.userSelected}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.lg.userEnd,required:"",prop:"distributortime"}},[i("el-date-picker",{attrs:{type:"date","value-format":"timestamp"},model:{value:e.formData.distributortime,callback:function(t){e.$set(e.formData,"distributortime",t)},expression:"formData.distributortime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.lg.imei,required:"",prop:"imeis"}},[i("div",{staticClass:"fl"},[i("el-input",{directives:[{name:"showClear",rawName:"v-showClear"}],staticStyle:{width:"220px"},attrs:{type:"textarea",rows:4,placeholder:e.lg.oneImeiOneLine},on:{blur:function(t){return e.trimImeiInput("formData","imeis")}},model:{value:e.formData.imeis,callback:function(t){e.$set(e.formData,"imeis",t)},expression:"formData.imeis"}}),e._v(" "),i("p",{staticClass:"desc"},[e._v(e._s(e.lg.maxImeiNum.replace("{num}",200)))])],1),e._v(" "),i("div",{staticClass:"fl"},[i("imeiListComp",{ref:"imeiListComp",on:{setImeis:e.setImeis,getImeis:e.getImeis}})],1)]),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary","native-type":"submit",loading:e.btnloading}},[e._v(e._s(e.lg.submit))]),e._v(" "),e.dialog?i("el-button",{on:{click:e.cancelFn}},[e._v(e._s(e.lg.cancel))]):i("el-button",{on:{click:e.reset}},[e._v(e._s(e.lg.reset))])],1)],1)},staticRenderFns:[]},u=i("VU/8")(c,l,!1,null,null,null);t.default=u.exports},Glw6:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("gyMJ"),n=(i("iKHV"),i("VV4h")),s=i("eInf"),o=i("sQMB"),a=i("KvKp"),c={data:function(){return{filter:"0",visible:!1,loading:!1,imeiComp:null,repeatImei:[],reocrds:[]}},components:{membership:n.default,imeiDetail:s.default,platformComp:o.default},computed:{normalNum:function(){return this.reocrds.filter(function(e){return e.isok}).length},errorNum:function(){return this.reocrds.filter(function(e){return!e.isok}).length},repeatData:function(){},repeatNum:function(){return this.repeatImei.length},filterData:function(){var e=this;return"0"==this.filter?this.reocrds:"1"==this.filter?this.reocrds.filter(function(e){return e.isok}):"2"==this.filter?this.reocrds.filter(function(e){return!e.isok}):"3"==this.filter?this.reocrds.filter(function(t){return e.inArray(e.repeatImei,t.imei)}):void 0}},methods:{checkClick:function(){this.$emit("getImeis")},rowClassFn:function(e){var t=e.row;e.rowIndex;return t.isok?"":"table-row-error"},beforeDestroy:function(){this.imeiComp=null},setRepeatData:function(e){if(e){var t=[],i=[];(e=e.replaceAll("\n",",").split(",")).forEach(function(e){-1!=t.indexOf(e)?i.push(e):t.push(e)}),this.repeatImei=i}},getImeisInfoData:function(e){var t=this;e&&(e=this.$trim(e),this.setRepeatData(e),e=this.formatImeis(e),this.loading=!0,Object(r._49)({imeis:e.join(",")}).then(function(e){t.visible=!t.visible,t.reocrds=e.records,t.loading=!1}).catch(function(e){t.loading=!1}))},showFn:function(){Object(a.k)(document,"click",this.handleDocumentClick)},handleDocumentClick:function(e){this.imeiComp&&this.imeiComp.$el.contains(e.target)||this.$refs.membershipComp&&this.$refs.membershipComp.$el.contains(e.target)||(this.visible=!1)},hideFn:function(){Object(a.j)(document,"click",this.handleDocumentClick)},filterClick:function(){var e=[];this.filterData.forEach(function(t){e.push(t.imei)}),this.$emit("setImeis",e)},setImeiComp:function(e){this.imeiComp=e},showMembership:function(e){this.$refs.membershipComp.setVisible(!0),this.$refs.membershipComp.getRelationship(e.customerid)}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-popover",{ref:"imeiPopover",attrs:{"popper-class":"imei-list-popover",placement:"right",width:"400",trigger:"manual"},on:{"after-enter":e.showFn,"after-leave":e.hideFn},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("el-tabs",{on:{"tab-click":e.filterClick},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[i("el-tab-pane",{attrs:{label:e.lg.all+"("+e.reocrds.length+")",name:"0"}}),e._v(" "),i("el-tab-pane",{attrs:{label:e.lg.normal+"("+e.normalNum+")",name:"1"}}),e._v(" "),i("el-tab-pane",{attrs:{label:e.lg.repeated+"("+e.repeatNum+")",name:"3"}}),e._v(" "),i("el-tab-pane",{attrs:{label:e.lg.error+"("+e.errorNum+")",name:"2"}})],1),e._v(" "),i("el-button",{staticClass:"popver-close-btn",attrs:{type:"info",round:"",icon:"el-icon-close"},on:{click:function(t){e.visible=!1}}}),e._v(" "),i("el-table",{attrs:{data:e.filterData,"max-height":"300","row-class-name":e.rowClassFn}},[i("el-table-column",{attrs:{width:"150",property:"imei",label:e.lg.imei},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isok?[i("imeiDetail",{attrs:{record:{deviceid:t.row.id,imei:t.row.imei}},on:{dialogShow:e.setImeiComp}})]:[e._v("\n          "+e._s(t.row.imei)+"\n        ")]]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"100",property:"devicetype",label:e.lg.targetType}}),e._v(" "),i("el-table-column",{attrs:{width:"150",label:e.lg.membershipCustomer},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isok?[i("a",{staticClass:"txt-ellipsis link-btn",on:{click:function(i){return e.showMembership(t.row)}}},[e._v(e._s(t.row.customername))])]:[i("div",{staticClass:"txt-ellipsis"},[i("p",[e._v(e._s(e.lg[t.row.errorcode]))]),e._v(" "),"20005"==t.row.errorcode?[i("platformComp",{attrs:{imeis:t.row.imei}})]:e._e()],2)]]}}])})],1),e._v(" "),i("el-button",{staticClass:"check-imei-btn",attrs:{slot:"reference",loading:e.loading},on:{click:e.checkClick},slot:"reference"},[e._v(e._s(e.lg.check))]),e._v(" "),i("membership",{ref:"membershipComp"})],1)},staticRenderFns:[]};var u=i("VU/8")(c,l,!1,function(e){i("fY/y")},null,null);t.default=u.exports},NPiI:function(e,t){},Rpa2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("gyMJ"),n={props:["defaultUserInfo","treeType"],prop:["width"],data:function(){return{activeName:"",name:"",num:10,notFirst:!1,showTree:!1}},components:{tree:i("zAgK").default},methods:{changeFn:function(){""==this.$trim(this.name)&&(this.activeName="",this.callbackComp({customerid:"",name:""}))},querySearchAsync:function(e,t){var i=this,n=this.$trim(e);if(""==n)return t([]);Object(r.U)({query:n,num:this.num}).then(function(e){t(e.suggestions),i.$refs.userTreeInput.handleFocus()}).catch(function(e){})},handleSelect:function(e){this.activeName=e.value,this.callbackComp({customerid:e.data,name:e.value,roletype:e.roletype})},treeNodeClick:function(e){this.callbackComp({customerid:e.id,name:e.name,roletype:e.roletype}),this.name=e.name,this.hideTree(),this.activeName=e.account?(e._name?e._name:e.name)+"("+e.account+")":""},setCustomer:function(e){this.name=e},refresh:function(){this.$refs.treeComp.refresh()},toggleTree:function(){this.notFirst=!0,this.showTree=!this.showTree},hideTree:function(){this.showTree=!1},clearFn:function(){this.name="",this.activeName=""},callbackComp:function(e){this.$emit("selected",e)},focusAutoComp:function(e){document.getElementById("tips").style.display="none",this.checkPopupPosition(e)},checkPopupPosition:function(e){if(0!=document.body.scrollLeft)for(var t=document.querySelectorAll(".el-dialog__body"),i=0,r=t.length;i<r;i++)t[i].hasChildNodes(e.target)&&(document.body.scrollLeft=0)},setDefaultUserInfo:function(e){e&&(this.defaultUserInfo=e,this.treeNodeClick(this.defaultUserInfo))}},mounted:function(){var e=this;e.defaultUserInfo&&e.treeNodeClick(e.defaultUserInfo),document.body.addEventListener("click",function(t){e.hideTree()})}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"user-tree-select"},[i("div",{directives:[{name:"tip",rawName:"v-tip",value:e.activeName,expression:"activeName"}],attrs:{"data-tips":e.activeName}},[i("el-autocomplete",{ref:"userTreeInput",attrs:{"trigger-on-focus":!1,"fetch-suggestions":e.querySearchAsync,"popper-class":"user-autocomplete",clearable:"",placeholder:e.lg.selectHint},on:{select:e.handleSelect,focus:function(t){return e.focusAutoComp(t)},input:e.changeFn},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.item;return[i("i",{staticClass:"user-icon",class:"user-icon-"+r.roletype}),e._v(" "),i("div",{staticClass:"info"},[i("div",{staticClass:"s-name"},[e._v(e._s(r.name))]),e._v(" "),i("span",{staticClass:"s-account"},[e._v(e._s(r.account))])])]}}]),model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[i("el-button",{staticClass:"select-btn",attrs:{slot:"append",icon:e.showTree?"el-icon-arrow-up":"el-icon-arrow-down"},on:{click:function(t){return t.stopPropagation(),e.toggleTree.apply(null,arguments)}},slot:"append"})],1)],1),e._v(" "),e.notFirst?i("div",{directives:[{name:"show",rawName:"v-show",value:e.showTree,expression:"showTree"}],staticClass:"treeBox"},[i("tree",{ref:"treeComp",attrs:{treeType:e.treeType},on:{treeNodeClick:e.treeNodeClick}})],1):e._e()])},staticRenderFns:[]};var o=i("VU/8")(n,s,!1,function(e){i("NPiI")},null,null);t.default=o.exports},UdMx:function(e,t){},bOdI:function(e,t,i){"use strict";t.__esModule=!0;var r,n=i("C4MV"),s=(r=n)&&r.__esModule?r:{default:r};t.default=function(e,t,i){return t in e?(0,s.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},"fY/y":function(e,t){},gFTv:function(e,t){},iKHV:function(e,t,i){"use strict";i.d(t,"d",function(){return r}),i.d(t,"i",function(){return n}),i.d(t,"j",function(){return s}),i.d(t,"a",function(){return o}),i.d(t,"m",function(){return a}),i.d(t,"b",function(){return c}),i.d(t,"l",function(){return l}),i.d(t,"k",function(){return u}),i.d(t,"f",function(){return d}),i.d(t,"h",function(){return h}),i.d(t,"g",function(){return f}),i.d(t,"e",function(){return m}),i.d(t,"n",function(){return p}),i.d(t,"c",function(){return v}),i.d(t,"o",function(){return b});var r=function(e){return!(!e||!/^([0-9A-Za-z\_\@\.]){2,30}$/.test(e))},n=function(e){return!!(e&&e.length<=20&&e.length>=6)},s=function(e){return"123456"!=e},o=100,a=64,c=150,l=function(e){return!!e.match(/^(\+[0-9]{1,20}|[0-9]{1,21})$/)},u=function(e){return e.indexOf("@")>0&&e.indexOf(".")>0&&!!e.match(/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)},d=function(e){return/(^[a-zA-Z\d]{6,15}$)/.test(e)},h=function(e){return/(^[a-zA-Z\d]{5,18}$)/.test(e)},f=function(e){for(var t,i=[],r=!0,n=0,s=e.length;n<s;n++)if(t=e[n].replace(/^\s+|\s+$/gm,""),i.push(t),!d(t)){r=!1;break}return{imeis:i,rs:r}},m=function(e){return!!(/^\d+(\.5)?$/.test(e)&&parseInt(e)>=0&&parseInt(e)<=5e3)},p=function(e,t){var i={beginTime:(t=t||"")?new Date(new Date(t).getTime()).setHours(0,0,0,0):(new Date).getTime()};return i.endTime=i.beginTime+864e5*e-1,i},g=function(e,t){if(e+="",t||(t=0),-1==e.indexOf(".")&&(e+="."),e+=new Array(t+1).join("0"),new RegExp("^(-|\\+)?(\\d+(\\.\\d{0,"+(t+1)+"})?)\\d*$").test(e)){e="0"+RegExp.$2;var i=RegExp.$1,r=RegExp.$3.length,n=!0;if(r==t+2){if(r=e.match(/\d/g),parseInt(r[r.length-1])>4)for(var s=r.length-2;s>=0&&(r[s]=parseInt(r[s])+1,10==r[s]);s--)r[s]=0,n=1!=s;e=r.join("").replace(new RegExp("(\\d+)(\\d{"+t+"})\\d$"),"$1.$2")}return n&&(e=e.substr(1)),parseFloat((i+e).replace(/\.$/,""))}return e+""},v=function(e,t,i){return 0==e&&"temperature"!=t||void 0===i?e:"distance"==t?g("2"==i?.621*e:e,2):"pressure"==t?["",g(.145*e,2),g(.01*e,2),g(e,2)][i]:"capacity"==t?["",g(e,2),g(.264*e,2),g(.22*e,2)][i]:"temperature"==t?g("2"==i?1.8*e+32:e,2):"fuelefficiency"==t?["",g(e,2),g(62.1/(.264*e),2),g(62.1/(.22*e),2)][i]:e},b=function(e,t,i){return 0==e&&"temperature"!=t||void 0===i?e:"distance"==t&&1!=i?g(e/.621,2):"pressure"==t?["",g(e/.145,2),g(e/.01,2),g(e,2)][i]:"capacity"==t?["",g(e,2),g(e/.264,2),g(e/.22,2)][i]:"temperature"==t?g("2"==i?(e-32)/1.8:e,2):"fuelefficiency"==t?["",g(e,2),g(62.1/(.264*e),2),g(62.1/(.22*e),2)][i]:e}},mClu:function(e,t,i){var r=i("kM2E");r(r.S+r.F*!i("+E39"),"Object",{defineProperty:i("evD5").f})},sQMB:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("iKHV"),n=i("gyMJ"),s={props:["imeis"],data:function(){return{records:[],visible:!1,loading:!1,oPlatform:{"-1":lg.noSuchIMEI,0:lg.notInBlackList,1:"Protrack",2:"Itrack/SWD",3:"ProtrackAsia"}}},computed:{hasAuth:function(){return this.$store.state.functions&&this.$store.state.functions.checkinwhitelist}},methods:{getInfo:function(){var e=this;if(this.loading=!0,!this.imeis||!Object(r.h)(this.imeis))return this.$message.error(lg[20053]);Object(n.M)({imeis:this.imeis}).then(function(t){e.records=t.record,e.loading=!1}).catch(function(t){e.loading=!1})},fmtPlatform:function(e,t,i,r){return this.oPlatform[i]},fmtTime:function(e,t,i,r){return i?this.utcToLocal(i):"-"},hide:function(){this.records=[]}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.hasAuth?i("el-popover",{attrs:{"popper-class":"platform-popover",placement:"bottom",target:"manual",width:"550"},on:{"after-leave":e.hide},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("el-button",{staticClass:"popver-close-btn",attrs:{type:"info",round:"",icon:"el-icon-close"},on:{click:function(t){e.visible=!1}}}),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.records,stripe:""}},[i("el-table-column",{attrs:{type:"index",align:"center",label:e.lg.serialNum,width:"48"}}),e._v(" "),i("el-table-column",{attrs:{prop:"imei",label:"IMEI",width:"160"}}),e._v(" "),i("el-table-column",{attrs:{prop:"type",label:e.lg.platform,formatter:e.fmtPlatform}}),e._v(" "),i("el-table-column",{attrs:{prop:"importTime",label:e.lg.importTime,formatter:e.fmtTime,width:"160"}})],1),e._v(" "),i("a",{staticClass:"link-btn",attrs:{slot:"reference"},on:{click:e.getInfo},slot:"reference"},[e._v("查看所属平台"),i("i",{staticClass:"el-icon-d-arrow-right",staticStyle:{"font-size":"11px"}})])],1):e._e()},staticRenderFns:[]};var a=i("VU/8")(s,o,!1,function(e){i("gFTv")},null,null);t.default=a.exports},zAgK:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("bOdI"),n=i.n(r),s=i("gyMJ"),o=i("KvKp"),a={props:["treeType","showCheckbox","rightClickFlag"],data:function(){return{treetype:"1",orderKey:"name",orderType:"asc",firstNode:null,firstResolve:null,deviceid:"",rightDisplay:!1,rightClickStatus:!1,hideRightTime:null,hoverRightTime:null,treeShow:!0,curUserId:"",optionleft:-1e4,optiontop:-1e4,defaultExpand:[],clickNum:0,dbClickTimeObj:null,defaultProps:{label:"name",children:[],isLeaf:"leaf"},refreshFlag:!1,loading:!1}},computed:{loginId:function(){return this.$store.state.customerInfo.id},firstData:function(){return this.$store.state.tree.first},childData:function(){return this.$store.state.tree.child}},components:{treeRight:function(){return i.e(132).then(i.bind(null,"XeIX"))}},methods:{reloadTree:function(e){this.treetype!=e&&(this.refreshFlag=!0,this.treetype=e||"1",this.loadNode(this.firstNode,this.firstResolve))},reloadTreeParent:function(){if(this.orderKey=Object(o.c)("treeCustomerOrderBy")||"name",this.orderType=Object(o.c)("treeCustomerOrderType")||"asc",this.curUserId){this.refreshFlag=!0;var e=this.$refs.tree.getNode(this.curUserId);e.parent.loaded=!1,e.parent.expand()}},refresh:function(){if(this.curUserId){this.refreshFlag=!0;var e=this.$refs.tree.getNode(this.curUserId);this.getSelfData(e),e.loaded=!1,e.expand()}},refreshNode:function(e,t){this.refreshFlag=!0,this.getSelfData(t),t.loaded=!1,t.expand(),e.stopPropagation()},refreshSelf:function(){if(this.curUserId){var e=this.$refs.tree.getNode(this.curUserId);this.getSelfData(e)}},loadNode:function(e,t){0===e.level?(this.firstNode=e,this.firstResolve=t,this.firstNode.childNodes=[],this.getFirstData(t)):e.level>=1&&this.getChildData(e,t)},getSelfData:function(e){var t=this;Object(s._155)({customerid:e.data.id,treetype:this.treetype}).then(function(i){var r=i.record;e.data.name=("account"==t.orderKey?r.account:r.name)+"("+r.ownnum+"/"+r.totalnum+")",e.data.account=r.account,e.data.role=r.role,e.data.roletype=r.roletype,e.data.type=r.type,e.data.isread=r.isread,e.data._name=r._name}).catch(function(e){})},getFirstData:function(e){var t=this,i=1==this.treetype;this.firstData&&i?this.renderFirst(e,this.firstData):(this.loading=!0,this.$store.dispatch("getTreeFirst",{param:{customerid:this.loginId,treetype:this.treetype},save:i}).then(function(i){t.renderFirst(e,i.record),t.loading=!1,t.$emit("treeLoaded")}).catch(function(e){t.loading=!1}))},renderFirst:function(e,t){var i;e([(i={id:t.customerid,name:t.name+"("+t.ownnum+"/"+t.totalnum+")",_name:t.name,account:t.account,leaf:!t.hadchild,type:t.type,role:t.role,roletype:t.roletype},n()(i,"_name",t.name),n()(i,"isread",t.isread),i)]),t.hadchild&&!this.inArray(this.defaultExpand,t.customerid)&&this.defaultExpand.push(t.customerid);var r=this;setTimeout(function(){r.$refs.tree.setCurrentKey(t.customerid)},0)},getChildData:function(e,t){var i=this,r=1==e.level&&1==this.treetype;this.childData&&r&&!this.refreshFlag?this.renderChild(e,t,this.childData):this.$store.dispatch("getTreeChild",{param:{customerid:e.data.id,puretree:1,treetype:this.treetype},save:r}).then(function(r){if(i.refreshFlag=!1,!r.record)return t([]);i.renderChild(e,t,r.record)}).catch(function(e){i.refreshFlag=!1})},renderChild:function(e,t,i){for(var r=[],n=0,s=(i=this.treeSortor(i)).length;n<s;n++)r.push({id:i[n].id,name:("account"==this.orderKey?i[n].account:i[n].name)+"("+i[n].ownnum+"/"+i[n].totalnum+")",account:i[n].account,leaf:!i[n].hadchild,type:i[n].type,role:i[n].role,roletype:i[n].roletype,_name:i[n].name,isread:i[n].isread});t(r)},treeSortor:function(e){var t,i=this;switch(i.orderKey){case"name":case"account":return e.sort(function(e,r){return t=e[i.orderKey].localeCompare(r[i.orderKey]),"asc"==i.orderType?t:-t});case"id":case"ownnum":case"totalnum":return e.sort(function(e,r){return t=e[i.orderKey]-r[i.orderKey],"asc"==i.orderType?t:-t});default:return e}},renderContent:function(e,t){var i=this,r=t.node,n=t.data,s=(t.store,void 0),o="",a=n._name+"("+n.account+")";return"1"==n.role?s=e("div",{class:"custom-tree-node fl",directives:[{name:"tip",value:["<div style=\"padding-left:20px;background-image:url('/dealer/images/vip.png');background-repeat:no-repeat;background-position:-6px -2px;\">"+lg.superAdmin+"</div>","<div>"+a+"</div>"].join("\n")}]},[e("div",{class:"custom-tree-node-cont"},[e("i",{class:"tree-icon "+(n.leaf?"userIcon"+n.type:"userIconArr"+n.type)}),e("span",{class:"tree-node-word "+("1"==n.role?"red":"")},[n.name]),this.rightClickFlag?e("span",{class:"el-icon-more-v",on:{click:function(e){return i.clickShowMore(e,n)}}}):e("span",{class:"tree-refresh el-icon-refresh",on:{click:function(e){return i.refreshNode(e,r)}}})])]):(o=n.leaf?"userIcon"+n.type:"userIconArr"+n.type,1==n.isread&&(1==n.type&&(o="dealerIconReadonly"),2==n.type&&(o="userIconReadonly")),s=e("div",{class:"custom-tree-node fl",directives:[{name:"tip",value:a}]},[e("div",{class:"custom-tree-node-cont"},[e("i",{class:"tree-icon "+o}),e("span",{class:"tree-node-word"},[n.name]),this.rightClickFlag?e("span",{class:"el-icon-more-v",on:{click:function(e){return i.clickShowMore(e,n)},mouseover:function(e){return i.hoverShowMore(e,n)},mouseout:function(e){return i.hoverHideMore(e,n)}}}):e("span",{class:"tree-refresh el-icon-refresh",on:{click:function(e){return i.refreshNode(e,r)}}})])])),s},clickShowMore:function(e,t){this.rightClickStatus=!0,this.showRightClick(e,t),e.stopPropagation()},hoverShowMore:function(e,t){if(clearTimeout(this.hideRightTime),!this.rightClickStatus){var i=this;this.hoverRightTime=setTimeout(function(){i.showRightClick(e,t)},300),e.stopPropagation()}},hoverHideMore:function(){clearTimeout(this.hoverRightTime);var e=this;this.hideRightTime=setTimeout(function(){e.hideRightOption()},500)},hideRightOption:function(){this.rightDisplay=!1,document.body.onclick=null,this.rightClickStatus=!1},rightOptionHover:function(){clearTimeout(this.hideRightTime)},rightOptionHoverOut:function(){var e=this;this.hideRightTime=setTimeout(function(){e.hideRightOption()},500)},rightClick:function(e,t){this.rightClickStatus=!0,this.showRightClick(e,t)},showRightClick:function(e,t){if(this.rightClickFlag){this.rightDisplay=!0;var i=this;setTimeout(function(){var r=i.$refs.treeRightComp.$el.offsetHeight,n=document.documentElement.clientHeight;i.optiontop=e.clientY+r>n?e.clientY-r:e.clientY,i.optionleft=e.clientX+15,i.$refs.treeRightComp.setData(t)},0),this.curUserId=t.id,document.body.onclick=function(){i.hideRightOption()}}},handleCheckChange:function(e,t,i){var r=this.$refs.tree.getCheckedNodes(),n=this.$refs.tree.getCheckedKeys();this.$emit("checkChange",{obj:r,key:n})},setCheckedKeys:function(e){this.$refs.tree.setCheckedKeys(e)},nodeClick:function(e,t,i){for(var r=t,n=[e.id];r&&r.parent&&r.parent.data;)n.push(r.parent.data.id),r=r.parent;this.$emit("treeNodeClick",e,n),this.curUserId=e.id,this.rightDisplay=!1,this.dbClick(window.event,e,t,i)},dbClick:function(e,t,i,r){if(e){this.clickNum++,2==this.clickNum&&(this.rightClickStatus=!0,this.showRightClick(e,t,i,r));var n=this;clearTimeout(this.dbClickTimeObj),this.dbClickTimeObj=setTimeout(function(){n.clickNum=0},500)}},selectTreeNode:function(e,t){var i="string"==typeof e.customers?e.customers.split(",").reverse().map(Number):e.customers,r=i.pop();this.defaultExpand=i;var n=this;!function e(){var i=n.$refs.tree.getNode(r);if(i&&!n.loading){if(n.$refs.tree.setCurrentKey(i.key),n.nodeClick(i.data,i),t){var s=n.$refs.tree.getCheckedKeys()||[];s.push(i.key),n.$refs.tree.setCheckedKeys(s)}}else setTimeout(function(){e()},200)}()},getCurrentNode:function(){return this.$refs.tree.getCurrentNode()},nodeExpandFn:function(e,t){this.defaultExpand.push(e.id),this.$emit("expanded")},nodeCollapseFn:function(e){this.defaultExpand.splice(this.defaultExpand.indexOf(e.id),1),this.$emit("collapse")}},mounted:function(){this.curUserId=this.loginId},created:function(){this.treetype=this.treeType?this.treeType:"1",this.orderKey=Object(o.c)("treeCustomerOrderBy")||"name",this.orderType=Object(o.c)("treeCustomerOrderType")||"asc"}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tree-comp"},[i("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.treeShow,expression:"treeShow"}],ref:"tree",attrs:{lazy:"",load:e.loadNode,props:e.defaultProps,"node-key":"id","default-expanded-keys":e.defaultExpand,"empty-text":e.lg.noData,accordion:!0,"expand-on-click-node":!1,"highlight-current":!0,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,"check-strictly":!0,"check-on-click-node":!0},on:{"node-click":e.nodeClick,"node-contextmenu":e.rightClick,"check-change":e.handleCheckChange,"node-expand":e.nodeExpandFn,"node-collapse":e.nodeCollapseFn}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.rightDisplay,expression:"rightDisplay"}],staticClass:"tree-right-option",style:{left:e.optionleft+"px",top:e.optiontop+"px"}},[i("treeRight",{ref:"treeRightComp",on:{reloadTreeParent:e.reloadTreeParent,refresh:e.refresh,refreshSelf:e.refreshSelf,mouseEnterEv:e.rightOptionHover,mouseLeaveEv:e.rightOptionHoverOut}})],1)],1)},staticRenderFns:[]};var l=i("VU/8")(a,c,!1,function(e){i("UdMx")},null,null);t.default=l.exports}});